<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache"/>
    <meta name="renderer" content="webkit"/>
    <meta name="author" content="SIRMly">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/index.css"/>
    <title>首页-敦煌研究院</title>
</head>
<body>
<div class="loading">
    <div class="night-bg"></div>
    <div class="day-bg">
        <div class="sun"></div>
        <div class="mountain"></div>
        <div class="deer"></div>
        <p id="progress">100%</p>
    </div>
</div>
<div class="container">
    <div class="content">
        <div class="nav clearfix po-re">
            <img src="img/index-logo.png" alt=""/>
            <ul class="nav-lists clearfix">
                <li class="pull-left nav-list my-center">
                    <a href="##"></a>
                </li>
                <li class="pull-left nav-list search">
                    <a href="##"></a>
                </li>
            </ul>
        </div>
        <div class="tiger-wrapper po-re">
            <img src="img/tiger-bg.png" alt="" width="100%"/>
            <div class="tiger tiger-left"></div>
            <div class="tiger tiger-right"></div>
            <div class="nav-circle"></div>
        </div>
        <div class="part1 po-re clearfix">
            <img src="img/montain1.png" alt="" width="100%" class="pull-right"/>
            <div class="part1-bird1"></div>
            <div class="part1-bird2"></div>
            <a href="##" class="part1-btn"></a>
        </div>
        <div class="part2 po-re">
            <div class="part2-bird3 po-re move">
                <div class="bird3-head"></div>
                <div class="bird3-tail"></div>
            </div>
        </div>
        <div class="part3 po-re">
            <div class="part3-deer po-re">
                <div class="part3-earLeft"></div>
                <div class="part3-earRight"></div>
                <div class="part3-legs">
                    <img src="img/part3-bone1.png" alt="" class="part3-bone1"/>
                    <div class="part3-legs2">
                        <img src="img/part3-bone2.png" alt="" class="part3-bone1"/>
                        <div class="part3-bone3"></div>
                    </div>
                </div>
                <img src="img/bagDeer.png" alt="" width="100%" class="part3-body"/>
            </div>
            <a href="##" class="part3-btn part-btn"></a>
        </div>
        <div class="part4 po-re">
            <div class="part4-fish"></div>
            <div class="part4-water"></div>
            <a href="##" class="part4-btn part-btn"></a>
            <div class="part4-flower"></div>
        </div>
        <div class="part5 po-re">
            <a href="##" class="part5-btn part-btn"></a>
            <div class="part5-deer po-re">
                <div class="part5-headW">
                    <div class="part5-mouth"></div>
                    <div class="part5-head"></div>
                </div>

            </div>
        </div>
        <div class="part6 po-re">
            <div class="part6-boat po-re">
                <div class="part6-stick"></div>
                <div class="part6-sail"></div>
            </div>
            <a href="##" class="part6-btn part-btn"></a>
        </div>
        <div class="part7 po-re">
            <div class="part7-cloudS"></div>
            <!--<div class="part7-bird"></div>-->
            <div class="part7-bg"></div>
            <div class="part7-cloudB"></div>
        </div>
        <div class="part8 po-re">
            <div class="part8-cloudS"></div>
            <div class="part8-bg"></div>
            <div class="part8-couples">
                <div class="left-body">
                    <div class="left-head"></div>
                </div>
                <div class="left-leg"></div>
                <div class="right-head">
                    <div class="right-mouth"></div>
                </div>
            </div>
            <div class="part8-cloudB"></div>
            <div class="lotus1"></div>
            <div class="lotus2"></div>
            <div class="lotus3"></div>
            <div class="part-btn part8-btn"></div>
            <div class="part8-crane">
                <div class="crane-mouth"></div>
                <div class="crane-body"></div>
                <div class="crane-eye"></div>
            </div>
            <div class="part8-leaf"></div>
        </div>
        <div class="part9 po-re">
            <div class="part9-deer1">
                <div class="part9-head"></div>
            </div>
            <div class="part-btn part9-btn"></div>
            <div class="part9-deer2"></div>
        </div>
        <div class="bottom po-re">
            <img src="img/index-bottom.png" alt=""/>
        </div>
        <a href="javascript:;" class="toTop"></a>
    </div>

    <div class="side">
        <div class="side-content">
            <ul class="side-lists">
                <li class="side-list">
                    <div class="main-title po-re">
                        <p class="toIndex">
                            <a href="##">首页</a>
                        </p>
                        <span class="side-icon"></span>
                    </div>
                </li>
                <li class="side-list">
                    <div class="main-title po-re">
                        <p>
                            <a href="##">本院总说</a>
                        </p>
                        <span class="side-icon"></span>
                    </div>
                    <div class="side-item clearfix">
                        <a href="##">本院简介</a>
                        <a href="##">机构设置</a>
                        <a href="##">院史编年</a>
                        <a href="##">学者信息</a>
                        <a href="##">捐赠信息</a>
                    </div>
                </li>
                <li class="side-list">
                    <div class="main-title po-re">
                        <p>
                            <a href="##">最新动态</a>
                        </p>
                        <span class="side-icon"></span>
                    </div>
                    <div class="side-item clearfix">
                        <a href="##">展览信息</a>
                        <a href="##">问卷调查</a>
                    </div>
                </li>
                <li class="side-list">
                    <div class="main-title po-re">
                        <p>
                            <a href="##">参观信息</a>
                        </p>
                        <span class="side-icon"></span>
                    </div>
                </li>
                <li class="side-list">
                    <div class="main-title po-re">
                        <p>
                            <a href="##">学术研究</a>
                        </p>
                        <span class="side-icon"></span>
                    </div>
                    <div class="side-item clearfix">
                        <a href="##">敦煌学</a>
                        <a href="##">文物保护</a>
                        <a href="##">考古</a>
                        <a href="##">美术</a>
                        <a href="##">合作交流</a>
                        <a href="##">敦煌学书架</a>
                    </div>
                </li>
                <li class="side-list">
                    <div class="main-title po-re">
                        <p>
                            <a href="##">公共教育</a>
                        </p>
                        <span class="side-icon"></span>
                    </div>
                    <div class="side-item clearfix">
                        <a href="##">学术讲座</a>
                        <a href="##">视频专辑</a>
                        <a href="##">志愿者</a>
                        <a href="##">活动信息</a>
                    </div>
                </li>
                <li class="side-list">
                    <div class="main-title po-re">
                        <p>
                            <a href="##">敦煌石窟</a>
                        </p>
                        <span class="side-icon"></span>
                    </div>
                    <div class="side-item clearfix">
                        <a href="##">莫高窟</a>
                        <a href="##">榆林窟</a>
                        <a href="##">西千佛洞</a>
                        <a href="##">东千佛洞</a>
                        <a href="##">五个庙</a>
                        <a href="##">下洞子</a>
                        <a href="##">旱峡口</a>
                    </div>
                </li>
                <li class="side-list">
                    <div class="main-title po-re">
                        <p>
                            <a href="##">丝路与敦煌</a>
                        </p>
                        <span class="side-icon"></span>
                    </div>
                    <div class="side-item clearfix">
                        <a href="##">世界石窟</a>
                        <a href="##">中国石窟</a>
                        <a href="##">佛教艺术</a>
                        <a href="##">丝路史话</a>
                    </div>
                </li>
                <li class="side-list">
                    <div class="main-title po-re">
                        <p>
                            <a href="##">便民服务</a>
                        </p>
                        <span class="side-icon"></span>
                    </div>
                    <div class="side-item clearfix">
                        <a href="##">失物招领</a>
                        <a href="##">交通出行</a>
                        <a href="##">敦煌美食</a>
                    </div>
                </li>
                <li class="side-list">
                    <div class="main-title po-re">
                        <p>
                            <a href="##">敦煌商城</a>
                        </p>
                        <span class="side-icon"></span>
                    </div>
                </li>
                <li class="side-list">
                    <div class="main-title po-re">
                        <p>
                            <a href="##">联系我们</a>
                        </p>
                        <span class="side-icon"></span>
                    </div>
                    <div class="side-item clearfix">
                        <a href="##">建议搜集</a>
                        <a href="##">合作投稿</a>
                    </div>
                </li>
            </ul>
            <a  href="javascript:;" class="toIndex side-back"></a>
        </div>
    </div>
</div>

<script src="js/jquery.min.js"></script>
<script>
    ;(function ($) {
        var click = "ontouchstart" in document ? "touchstart" : "click";
        /*==loading==*/
        /*==鹿==*/
        var deer = $(".deer");
        var deerTimer;
        deerMove();
        function deerMove(){
            var backPosition = 0;
            var deerLeft = -22;
            deerTimer = setInterval(function (){
                backPosition = (backPosition>=100 ? 0 :backPosition+50);
                deer.css({
                    "background-position-x": backPosition+"%"
                });
            },200);
        }
        /*==山==*/
        var mountain = $(".mountain");
        var mountainTimer;
        mountainTimer = setInterval(function (){
            mountain.stop().css({
                width : "+=0.3px",
                left : "-=0.2px"
            });
        },0,"linear");
        /*=progress==*/
        var imgs = [
            "img/bagDeer.png",
            "img/bird1.png",
            "img/bird2.png",
            "img/bird3-head.png",
            "img/bird3-tail.png",
            "img/bottom-bg.png",
            "img/crane.png",
            "img/crane-eye.png",
            "img/crane-mouth.png",
            "img/index-bottom.png",
            "img/index-logo.png",
            "img/left-body.png",
            "img/left-head.png",
            "img/left-leg.png",
            "img/lotus1.png",
            "img/lotus2.png",
            "img/lotus3.png",
            "img/montain1.png",
            "img/montain2.png",
            "img/nav.png",
            "img/nav-cicle.png",
            "img/part2-bird3.png",
            "img/part3bg.png",
            "img/part3-bone1.png",
            "img/part3-bone2.png",
            "img/part3-bone3.png",
            "img/part3-btn.png",
            "img/part3-earLeft.png",
            "img/part3-earRight.png",
            "img/part4-btn.png",
            "img/part4-fish.png",
            "img/part4-flower.png",
            "img/bg4.png",
            "img/part4-water.png",
            "img/part5-btn.png",
            "img/part5-deer.png",
            "img/part5-head.png",
            "img/part5-mouth.png",
            "img/bg5.png",
            "img/bg6.png",
            "img/part6-boat.png",
            "img/part6-btn.png",
            "img/part6-sail.png",
            "img/part6-stick.png",
            "img/bg7.png",
            "img/part7-cloudB.png",
            "img/part7-cloudS.png",
            "img/part8-btn.png",
            "img/bg3.png",
            "img/part8-cloudB.png",
            "img/part8-cloudS.png",
            "img/part8-couples.png",
            "img/bg8.png",
            "img/part8-leaf.png",
            "img/part9-btn.png",
            "img/part9-deer1.png",
            "img/part9-deer2.png",
            "img/part9-head.png",
            "img/right-head.png",
            "img/right-mouth.png",
            "img/side.png",
            "img/side-back.png",
            "img/side-bird.png",
            "img/side-icon.png",
            "img/bg9.png"
        ];
        var proBox = $("#progress");
        preload(imgs,proBox);
        function preload(imgs,proBox){
            var proNum = 0,
                count = imgs.length,
                proPercentage = 0;
            for(var i in imgs){
                var newImg = new Image();
                newImg.src = imgs[i];
                newImg.onload = function (){
                    proNum++;
                    proPercentage = Math.floor(proNum/count*100);
                    $(".night-bg").css({
                        opacity : (100-proPercentage)/100
                    });
                    $(".sun").css({
                        opacity : proPercentage/100
                    });
                    if(proNum>=count){
                        proPercentage=100;
                        page1();
                    }
                    proBox.html(proPercentage+"%");
                }
            }
        }
        function page1(){
            $(".loading").fadeOut(500);
            $(".container").fadeIn(500);
            clearInterval(mountainTimer);
            clearInterval(deerTimer);
        }

        /*==index动效==*/
        var win = $(window);
        var container = $(".container");
        var winW = win.width();
        var winH = win.height();
        /*==鱼==*/
        var part4 = $(".part4");
        var part4FishTop = part4.find(".part4-fish").offset().top + 0.16*winW;
//        var part7Bird = $(".part7-bird");
//        var part7BirdTop = part7Bird.offset().top;
        var part7 = $(".part7");
//        var part7Top = $(".part7").offset().top;
        var part7BirdShow = true;
        var part7BirdTimer;
        var partBtn = $(".part-btn");
        var part8Move = true;
        var part8Top = $(".part8").offset().top;
        container.scroll(function (){
            /*==btns==*/
            partBtn.each(function(index, item){
                if(!($(this).hasClass("show"))){
                    if(win.scrollTop()+winH*0.7 >= $(this).offset().top+$(this).height()*0.5 && win.scrollTop()+winH*0.2 <= $(this).offset().top+$(this).height()*0.5){
                        console.log(index);
                        partBtn.not($(this)).removeClass("show");
                        $(this).addClass("show");
                    }
                }
            });
            /*==鱼出来==*/
            if(!($(part4).hasClass("show"))){
                if($(window).scrollTop()+ winH*0.64 >= part4.find(".part4-fish").offset().top){
                    part4.addClass("show");
                }
            }
            /*==part7Bird==*/
            if(part7BirdShow){
                if($(window).scrollTop() >= (part7.offset().top - winH*0.3)){
//                    part7BirdMove();
                    part7BirdShow = false;
//                    part7Bird.addClass("move");
                    $(".part7-cloudB").addClass("show");
                    $(".part7-cloudS").addClass("show");
                }
            }

            /*==part8Move==*/
            if (part8Move) {
                if ($(window).scrollTop() >= ($(".part8").offset().top - winH*0.65)) {
                    part8Move = false;
                    $(".part8").addClass("show");
                }
            }
        });
//        function part7BirdMove(){
//            var backPosition = 0;
//            var part7BirdTimer = setInterval(function (){
//                backPosition = (backPosition>=100 ? 0 :backPosition+100);
//                part7Bird.css({
//                    "background-position-x": backPosition+"%"
//                });
//                if(part7Bird.position().left >= 0.48*winW){
//                    clearInterval(part7BirdTimer);
//                }
//            },500);
//        }




        /*==回到顶部==*/
        var click = "ontouchstart" in document ? "touchstart" : "click";
        $(".toTop").on(click, function () {
            container.stop().animate({
                "scrollTop": 5
            }, 1000);
        });


        /*==侧边栏==*/
        console.log($(".toIndex").length);
        $(".nav-circle").on(click, function (){
            $(".side").animate({
                left : 0
            },800,"swing");
        });

        $(document).on(click,".toIndex",function (){
            $(".side").animate({
                left : "100%"
            },800,"swing");
        });
        $(".main-title a").on(click, function () {
            var thisParent = $(this).closest(".main-title");
            if (!(thisParent.hasClass("active"))) {
                $(".main-title").removeClass("active");
                $(".side-item").stop().slideUp(500);
                if (thisParent.next().hasClass("side-item")) {
                    thisParent.next(".side-item").stop().slideDown(600);
                    thisParent.addClass("active");
                }
            } else {
                if (thisParent.next().hasClass("side-item")) {
                    thisParent.next(".side-item").stop().slideUp(500);
                    thisParent.removeClass("active");
                }
            }
        });
    })(jQuery);
</script>
</body>
</html>